<!doctype html>
<html  xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Checkout</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" th:href="@{/images/favicon.png}">
    <!-- CSS Files -->
    <link rel="stylesheet" th:href="@{/css/material-design-iconic-font.min.css}">
    <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/style.css}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-KyZXEAg3QhqLMpG8r+Knujsl5+5hb7ie1f3j5jtkI3w=" crossorigin="anonymous"></script>
</head>
<body>
    <div class="body-wrapper">
        <!-- Header Area -->
        <th:block th:insert="fragments/header :: header"></th:block>

        <!-- Breadcrumb -->
        <div class="breadcrumb-area">
            <div class="container">
                <div class="breadcrumb-content">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li class="active">Checkout</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Checkout Area -->
        <div class="checkout-area pt-60 pb-30">
            <div class="container">
                <div class="row">
                    <!-- Billing Details -->
                    <div class="col-lg-6 col-12">
                        <form id="billing-form">
                            <div class="checkbox-form">
                                <h3>Billing Details</h3>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="checkout-form-list">
                                            <label>First Name <span class="required">*</span></label>
                                            <input id="firstName" placeholder="John" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="checkout-form-list">
                                            <label>Last Name <span class="required">*</span></label>
                                            <input id="lastName" placeholder="Doe" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="checkout-form-list">
                                            <label>Email Address <span class="required">*</span></label>
                                            <input id="email" placeholder="example@mail.com" type="email">
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="checkout-form-list">
                                            <label>Phone <span class="required">*</span></label>
                                            <input id="phone" placeholder="123-456-7890" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="checkout-form-list">
                                            <label>Address <span class="required">*</span></label>
                                            <input id="address" placeholder="123 Main St" type="text">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Order Summary -->
                    <div class="col-lg-6 col-12">
                        <div class="your-order">
                            <h3>Your Order</h3>
                            <div class="your-order-table table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th class="cart-product-name">Product</th>
                                            <th class="cart-product-total">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cart-items">
                                        <!-- Cart items will be dynamically loaded here -->
                                    </tbody>
                                    <tfoot>
                                        <tr class="cart-subtotal">
                                            <th>Cart Subtotal</th>
                                            <td><span id="cart-subtotal">0৳</span></td>
                                        </tr>
                                        <tr class="order-total">
                                            <th>Order Total</th>
                                            <td><strong><span id="order-total">0৳</span></strong></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            <div class="order-button-payment">
                                <button id="place-order-btn" class="btn btn-primary">Place Order</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Area -->
        <th:block th:insert="fragments/footer :: footer"></th:block>
    </div>

      
    <script th:src="@{/js/vendor/jquery-1.12.4.min.js}"></script>
    <!-- Popper js -->
    <script th:src="@{/js/vendor/popper.min.js}"></script>
    <!-- Bootstrap V4.1.3 Framework js -->
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <!-- Ajax Mail js -->
    <script th:src="@{/js/ajax-mail.js}"></script>
    <!-- Meanmenu js -->
    <script th:src="@{/js/jquery.meanmenu.min.js}"></script>
    <!-- Wow.min js -->
    <script th:src="@{/js/wow.min.js}"></script>
    <!-- Slick Carousel js -->
    <script th:src="@{/js/slick.min.js}"></script>
    <!-- Owl Carousel-2 js -->
    <script th:src="@{/js/owl.carousel.min.js}"></script>
    <!-- Magnific popup js -->
    <script th:src="@{/js/jquery.magnific-popup.min.js}"></script>
    <!-- Isotope js -->
    <script th:src="@{/js/isotope.pkgd.min.js}"></script>
    <!-- Imagesloaded js -->
    <script th:src="@{/js/imagesloaded.pkgd.min.js}"></script>
    <!-- Mixitup js -->
    <script th:src="@{/js/jquery.mixitup.min.js}"></script>
    <!-- Countdown -->
    <script th:src="@{/js/jquery.countdown.min.js}"></script>
    <!-- Counterup -->
    <script th:src="@{/js/jquery.counterup.min.js}"></script>
    <!-- Waypoints -->
    <script th:src="@{/js/waypoints.min.js}"></script>
    <!-- Barrating -->
    <script th:src="@{/js/jquery.barrating.min.js}"></script>
    <!-- Jquery-ui -->
    <script th:src="@{/js/jquery-ui.min.js}"></script>
    <!-- Venobox -->
    <script th:src="@{/js/venobox.min.js}"></script>
    <!-- Nice Select js -->
    <script th:src="@{/js/jquery.nice-select.min.js}"></script>
    <!-- ScrollUp js -->
    <script th:src="@{/js/scrollUp.min.js}"></script>
    <!-- Main/Activator js -->
    <script th:src="@{/js/main.js}"></script>


   <script>
    $(document).ready(function () {
    // Select the container elements
    const cartItemsContainer = $('#cart-items');
    const cartSubtotal = $('#cart-subtotal');
    const orderTotal = $('#order-total');

    // AJAX call to fetch cart items
    $.ajax({
        url: '/api/cart', // API endpoint
        type: 'GET',      // HTTP method
        dataType: 'json', // Expect JSON data in response
        success: function (cartItems) {
            let subtotal = 0;

            // Loop through each item and append rows to the table
            cartItems.forEach(item => {
                const totalItemPrice = item.price * item.quantity;
                subtotal += totalItemPrice;

                // Append item details to the table body
                cartItemsContainer.append(`
                    <tr>
                        <td>${item.name} x ${item.quantity}</td>
                        <td>${totalItemPrice.toFixed(2)}৳</td>
                    </tr>
                `);
            });

            // Update the subtotal and total
            cartSubtotal.text(`${subtotal.toFixed(2)}৳`);
            orderTotal.text(`${subtotal.toFixed(2)}৳`);
        },
        error: function (xhr, status, error) {
            console.error('Error fetching cart items:', error);
            alert('Failed to load cart items. Please try again later.');
        }
    });
});

   </script>
</body>
</html>
